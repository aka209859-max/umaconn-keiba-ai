"""
オッズ別補正係数マスタ

CEOから提供された単勝配当補正係数と複勝配当補正係数を統合
"""

# 単勝配当補正係数（123段階）
TANSHO_CORRECTION = [
    (0.0, 1.0, 1.00),
    (1.0, 1.6, 0.94),
    (1.6, 1.8, 1.01),
    (1.8, 2.0, 1.05),
    (2.0, 2.2, 1.05),
    (2.2, 2.4, 1.01),
    (2.4, 2.6, 1.00),
    (2.6, 2.8, 0.99),
    (2.8, 3.0, 0.99),
    (3.0, 3.2, 0.97),
    (3.2, 3.4, 1.00),
    (3.4, 3.6, 1.01),
    (3.6, 3.8, 0.95),
    (3.8, 4.0, 0.98),
    (4.0, 4.2, 1.04),
    (4.2, 4.4, 1.07),
    (4.4, 4.6, 1.02),
    (4.6, 4.8, 1.05),
    (4.8, 5.0, 0.99),
    (5.0, 5.2, 0.95),
    (5.2, 5.4, 0.99),
    (5.4, 5.6, 1.06),
    (5.6, 5.8, 1.03),
    (5.8, 6.0, 1.07),
    (6.0, 6.2, 1.00),
    (6.2, 6.4, 1.00),
    (6.4, 6.6, 0.99),
    (6.6, 6.8, 1.07),
    (6.8, 7.0, 1.02),
    (7.0, 7.2, 1.04),
    (7.2, 7.4, 1.01),
    (7.4, 7.6, 0.87),
    (7.6, 7.8, 1.04),
    (7.8, 8.0, 0.97),
    (8.0, 8.2, 1.06),
    (8.2, 8.4, 1.09),
    (8.4, 8.6, 1.03),
    (8.6, 8.8, 0.89),
    (8.8, 9.0, 1.03),
    (9.0, 9.2, 0.97),
    (9.2, 9.4, 0.92),
    (9.4, 9.6, 0.87),
    (9.6, 9.8, 0.91),
    (9.8, 10.0, 0.89),
    (10.0, 10.5, 1.01),
    (10.5, 11.0, 0.94),
    (11.0, 11.5, 0.93),
    (11.5, 12.0, 0.89),
    (12.0, 12.5, 0.94),
    (12.5, 13.0, 0.95),
    (13.0, 13.5, 0.98),
    (13.5, 14.0, 1.00),
    (14.0, 14.5, 0.97),
    (14.5, 15.0, 1.02),
    (15.0, 15.5, 1.00),
    (15.5, 16.0, 0.92),
    (16.0, 16.5, 1.24),
    (16.5, 17.0, 1.01),
    (17.0, 17.5, 0.91),
    (17.5, 18.0, 1.04),
    (18.0, 18.5, 1.09),
    (18.5, 19.0, 0.89),
    (19.0, 19.5, 0.88),
    (19.5, 20.0, 0.92),
    (20.0, 21.0, 0.93),
    (21.0, 22.0, 0.99),
    (22.0, 23.0, 0.93),
    (23.0, 24.0, 1.05),
    (24.0, 25.0, 0.97),
    (25.0, 26.0, 1.00),
    (26.0, 27.0, 0.83),
    (27.0, 28.0, 1.02),
    (28.0, 29.0, 0.88),
    (29.0, 30.0, 1.14),
    (30.0, 31.0, 1.04),
    (31.0, 32.0, 0.87),
    (32.0, 33.0, 0.94),
    (33.0, 34.0, 1.08),
    (34.0, 35.0, 0.90),
    (35.0, 36.0, 1.08),
    (36.0, 37.0, 0.93),
    (37.0, 38.0, 1.47),
    (38.0, 39.0, 0.84),
    (39.0, 40.0, 1.15),
    (40.0, 41.0, 1.04),
    (41.0, 42.0, 1.12),
    (42.0, 43.0, 0.97),
    (43.0, 44.0, 1.07),
    (44.0, 45.0, 1.01),
    (45.0, 46.0, 1.14),
    (46.0, 47.0, 1.60),
    (47.0, 48.0, 0.87),
    (48.0, 49.0, 1.32),
    (49.0, 50.0, 1.25),
    (50.0, 55.0, 1.07),
    (55.0, 60.0, 0.93),
    (60.0, 65.0, 1.05),
    (65.0, 70.0, 1.28),
    (70.0, 75.0, 1.28),
    (75.0, 80.0, 0.80),
    (80.0, 85.0, 1.29),
    (85.0, 90.0, 1.06),
    (90.0, 95.0, 0.96),
    (95.0, 100.0, 1.31),
    (100.0, 110.0, 1.19),
    (110.0, 120.0, 1.08),
    (120.0, 130.0, 2.02),
    (130.0, 140.0, 1.40),
    (140.0, 150.0, 1.31),
    (150.0, 160.0, 1.39),
    (160.0, 170.0, 1.61),
    (170.0, 180.0, 1.53),
    (180.0, 190.0, 1.18),
    (190.0, 200.0, 2.80),
    (200.0, 220.0, 2.78),
    (220.0, 240.0, 2.04),
    (240.0, 260.0, 1.32),
    (260.0, 280.0, 3.02),
    (280.0, 300.0, 1.94),
    (300.0, 350.0, 1.83),
    (350.0, 400.0, 4.60),
    (400.0, 999999.9, 2.38),
]

# 複勝配当補正係数（108段階）
FUKUSHO_CORRECTION = [
    (0.0, 1.0, 1.00),
    (1.0, 1.1, 0.85),
    (1.1, 1.2, 0.93),
    (1.2, 1.3, 0.95),
    (1.3, 1.4, 0.95),
    (1.4, 1.5, 0.99),
    (1.5, 1.6, 1.01),
    (1.6, 1.7, 1.02),
    (1.7, 1.8, 1.05),
    (1.8, 1.9, 1.04),
    (1.9, 2.0, 1.04),
    (2.0, 2.1, 1.02),
    (2.1, 2.2, 1.02),
    (2.2, 2.3, 1.03),
    (2.3, 2.4, 1.02),
    (2.4, 2.5, 0.99),
    (2.5, 2.6, 1.01),
    (2.6, 2.7, 1.00),
    (2.7, 2.8, 0.98),
    (2.8, 2.9, 1.05),
    (2.9, 3.0, 1.04),
    (3.0, 3.1, 1.05),
    (3.1, 3.2, 1.02),
    (3.2, 3.3, 1.00),
    (3.3, 3.4, 1.03),
    (3.4, 3.5, 0.95),
    (3.5, 3.6, 0.99),
    (3.6, 3.7, 1.03),
    (3.7, 3.8, 0.94),
    (3.8, 3.9, 0.99),
    (3.9, 4.0, 1.02),
    (4.0, 4.1, 1.07),
    (4.1, 4.2, 1.00),
    (4.2, 4.3, 1.04),
    (4.3, 4.4, 1.04),
    (4.4, 4.5, 0.99),
    (4.5, 4.6, 0.98),
    (4.6, 4.7, 1.01),
    (4.7, 4.8, 1.06),
    (4.8, 4.9, 1.00),
    (4.9, 5.0, 1.06),
    (5.0, 5.2, 1.02),
    (5.2, 5.4, 1.01),
    (5.4, 5.6, 0.98),
    (5.6, 5.8, 0.94),
    (5.8, 6.0, 0.99),
    (6.0, 6.2, 1.06),
    (6.2, 6.4, 1.18),
    (6.4, 6.6, 1.01),
    (6.6, 6.8, 0.98),
    (6.8, 7.0, 0.99),
    (7.0, 7.2, 0.93),
    (7.2, 7.4, 0.97),
    (7.4, 7.6, 1.10),
    (7.6, 7.8, 1.09),
    (7.8, 8.0, 1.01),
    (8.0, 8.2, 1.09),
    (8.2, 8.4, 0.95),
    (8.4, 8.6, 0.97),
    (8.6, 8.8, 0.97),
    (8.8, 9.0, 1.08),
    (9.0, 9.2, 1.06),
    (9.2, 9.4, 1.08),
    (9.4, 9.6, 1.11),
    (9.6, 9.8, 0.93),
    (9.8, 10.0, 1.06),
    (10.0, 10.5, 1.07),
    (10.5, 11.0, 1.07),
    (11.0, 11.5, 1.08),
    (11.5, 12.0, 1.10),
    (12.0, 12.5, 0.97),
    (12.5, 13.0, 1.03),
    (13.0, 13.5, 1.07),
    (13.5, 14.0, 1.15),
    (14.0, 14.5, 1.09),
    (14.5, 15.0, 0.98),
    (15.0, 15.5, 1.15),
    (15.5, 16.0, 1.01),
    (16.0, 16.5, 0.96),
    (16.5, 17.0, 1.10),
    (17.0, 17.5, 1.37),
    (17.5, 18.0, 1.17),
    (18.0, 18.5, 1.19),
    (18.5, 19.0, 1.22),
    (19.0, 19.5, 1.43),
    (19.5, 20.0, 1.33),
    (20.0, 21.0, 1.35),
    (21.0, 22.0, 1.44),
    (22.0, 23.0, 1.32),
    (23.0, 24.0, 1.29),
    (24.0, 25.0, 1.46),
    (25.0, 26.0, 1.33),
    (26.0, 27.0, 1.37),
    (27.0, 28.0, 1.72),
    (28.0, 29.0, 1.42),
    (29.0, 30.0, 2.03),
    (30.0, 32.0, 1.55),
    (32.0, 34.0, 1.87),
    (34.0, 36.0, 1.81),
    (36.0, 38.0, 2.37),
    (38.0, 40.0, 1.81),
    (40.0, 45.0, 2.18),
    (45.0, 50.0, 2.35),
    (50.0, 55.0, 3.01),
    (55.0, 60.0, 2.62),
    (60.0, 70.0, 4.23),
    (70.0, 999999.9, 5.06),
]


def get_odds_correction(odds, is_fukusho=False):
    """
    オッズから補正係数を取得
    
    Args:
        odds: オッズ（float）
        is_fukusho: 複勝の場合True、単勝の場合False
    
    Returns:
        補正係数（float）
    """
    correction_table = FUKUSHO_CORRECTION if is_fukusho else TANSHO_CORRECTION
    
    for from_odds, to_odds, correction in correction_table:
        if from_odds <= odds < to_odds:
            return correction
    
    # 該当しない場合は1.0（補正なし）
    return 1.0


# 期間別重み係数（2016-2025の10年分）
YEAR_WEIGHTS = {
    '2016': 1,
    '2017': 2,
    '2018': 3,
    '2019': 4,
    '2020': 5,
    '2021': 6,
    '2022': 7,
    '2023': 8,
    '2024': 9,
    '2025': 10,
}


def get_year_weight(year):
    """
    年度から重み係数を取得
    
    Args:
        year: 年度（str or int）
    
    Returns:
        重み係数（int）
    """
    year_str = str(year)
    return YEAR_WEIGHTS.get(year_str, 0)


# 目標払戻額（均等払戻方式）
TARGET_PAYOUT = 10000  # 10,000円


def calculate_bet_amount(odds):
    """
    均等払戻方式のベット額を計算
    
    Args:
        odds: オッズ（float）
    
    Returns:
        ベット額（float）
    """
    if odds <= 0:
        return 0
    return TARGET_PAYOUT / odds
