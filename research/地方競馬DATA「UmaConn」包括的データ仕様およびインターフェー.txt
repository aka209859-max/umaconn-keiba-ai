地方競馬DATA「UmaConn」包括的データ仕様およびインターフェース解析報告書1. 序論：地方競馬データエコシステムにおけるUmaConnの位置付けと技術的意義1.1 報告書の目的と適用範囲本報告書は、地方競馬全国協会（NAR）管轄下の全競走データを配信するミドルウェア「UmaConn（ウマコン）」によって取得可能なデータ項目、ファクター、およびその構造的仕様を網羅的に解析し、技術仕様書としての水準で体系化したものである。本調査は、データエンジニア、クオンツアナリスト、および競馬予測システム開発者を対象としており、単なる項目リストの提示にとどまらず、各データファクターが持つドメイン固有の意味、データ型、リレーショナルデータベースにおける設計指針、さらには高度なデータサイエンスへの応用可能性について深く掘り下げることを目的としている。分析の対象範囲は、UmaConnが提供する「基本マスタ」「競走番組」「競走成績」「オッズ・票数情報」「拡張データ」の全領域に及ぶ。特に、業界標準のクライアントソフトウェアである「TARGET frontier JV（地方競馬版）」のデータ処理仕様や、開発者コミュニティにおけるCSV出力定義を逆解析することで、公式APIドキュメントが一般公開されていない領域についても、その内部データ構造を明らかにするアプローチを採用している。1.2 地方競馬データの特殊性とUmaConnの役割地方競馬（NAR）は、中央競馬（JRA）とは異なり、全国に散在する複数の主催者（ホッカイドウ競馬、南関東4競馬、ばんえい競馬など）によって運営されている。各主催者は歴史的に独自のデータ管理システムを運用してきた背景があり、これらのデータを統一的なフォーマットで統合・配信することは技術的に極めて難易度の高い課題であった。UmaConnは、この分散したデータソースを集約し、正規化（Normalization）を行った上でエンドユーザーに提供する「データ統合ミドルウェア」としての役割を果たしている。技術的には、クライアントPC上に常駐するローカルサーバーとして機能し、認証済みのデータストリームを受信して、JV-Data互換形式やCSV形式などの利用しやすいフォーマットに変換して出力する。このアーキテクチャにより、開発者は個々の競馬場のシステム差異を意識することなく、統一されたスキーマで全国の地方競馬データを扱うことが可能となっている。特に注目すべきは、UmaConnが提供するデータの「粒度」と「深度」である。単なる着順や配当情報にとどまらず、競走馬の5代血統、詳細なラップタイム、時系列オッズ（Tick Data）、さらには調教師や騎手の詳細な履歴データまでが含まれており、その情報量はビッグデータ解析に十分耐えうる規模を持っている。2. システムアーキテクチャとデータ接続仕様2.1 データ取得インターフェースの構造UmaConnを介したデータ取得プロセスは、現代的なRESTful APIとは異なり、専用のクライアントソフトウェアを経由したストリーム処理に近い形態をとる。インターフェース層技術仕様解説トランスポート層HTTPS / Proprietary Protocolデータセンターとの通信は暗号化され、専用の「利用キー」による認証が必要となる。ミドルウェア層UmaConn Client (Windows Service)ローカルマシン上で動作し、データのキャッシュ、差分更新（Delta Update）、整合性チェックを行う。アプリケーション層JV-Link互換API / CSV Export外部アプリケーション（TARGET等）やユーザープログラムがデータにアクセスするための接点。開発者が独自システムを構築する場合、最も一般的かつ堅牢な方法は、UmaConnが生成するCSVファイルを取り込むバッチ処理、またはJV-Link互換のDLL（Dynamic Link Library）を介してデータをメモリ上で直接操作する方法である。本報告書では、汎用性と可読性の観点から、主にCSV形式として出力可能なデータレイアウトを基準に詳細なフィールド定義を行う。2.2 データの更新頻度とリアルタイム性データエンジニアリングの観点から、データの「静的」性質と「動的」性質を理解することは不可欠である。UmaConnのデータストリームは以下の3つのカテゴリに分類され、それぞれ異なる更新サイクルを持つ。マスタデータ（Static Data）:競走馬、騎手、調教師、生産者、コース情報など。更新頻度：日次または随時（新規登録時）。特徴：参照整合性の基盤となるデータであり、変更されることは稀である。番組・事前データ（Pre-Race Dynamic Data）:出馬表、枠順、斤量、変更情報（騎手変更、取消）、天候、馬場状態。更新頻度：開催日の数日前から当日リアルタイムまで。特徴：レース発走に向けて徐々に情報が確定していくプロセスを持つ。速報・結果データ（Real-time & Post-Race Data）:オッズ、馬体重、レース結果、通過順、払戻金。更新頻度：数分間隔（オッズ）、レース直後（結果）。特徴：高頻度更新（High Frequency Update）が要求され、時系列分析の対象となる。3. データレイアウト詳解：基本マスタデータ（Entity Definitions）このセクションでは、データベース設計における「ディメンションテーブル」に相当する、各エンティティの具体的なフィールド構成とファクターについて解説する。3.1 競走馬マスタ (Horse Master Entity)競走馬データは、競馬分析における最も基本的かつ重要なエンティティである。UmaConnでは、地方競馬固有の事情（頻繁な移籍、改名）に対応しつつ、JBIS（Japan Bloodhorse Breeders' Association）等の国際標準に準拠した詳細な属性を保持している。データ構造の概要:1レコードは1頭の競走馬に対応し、その生物学的特徴および血統的背景を記述する。フィールド論理名データ型推定バイト数詳細定義と分析的視点血統登録番号Numeric (PK)8-10桁各競走馬に付与された一意の識別子。JRAおよびNARで共通の体系が用いられている場合が多く、システム間のデータ突合（マージ）におけるキーとなる。馬名String18-30bytesカタカナ表記の公式馬名。全角スペースの扱いや、促音・拗音の正規化が必要な場合がある。過去に改名があった場合の履歴管理も重要となる。性別コードCode1byte1:牡、2:牝、3:セン（去勢）。性別は競走能力や斤量規定に直接影響するため、必須のフィルタリング項目である。毛色コードCode2bytes01:栗毛、02:栃栗毛、03:鹿毛、04:黒鹿毛、05:青鹿毛、06:青毛、07:芦毛、08:白毛など。遺伝的な特徴を示すが、能力分析における直接的な相関は低いとされる。生年月日Date8bytesYYYYMMDD形式。馬齢の計算基準となる。早生まれ（1-3月）と遅生まれ（4-6月）の成長曲線の差異を分析するために使用される。調教師コードNumeric (FK)5-8桁現在所属している調教師のID。転厩履歴を追跡するためには、時系列のトランザクションテーブルとの結合が必要となる。調教師名String10-20bytes調教師の氏名。表示用。馬主コードNumeric (FK)5-8桁馬主のID。個人馬主、法人馬主、組合馬主が含まれる。馬主の経済的背景やエージェントの介入度合いを推測する手がかりとなる。馬主名String20-40bytes馬主の氏名または法人名。生産者コードNumeric (FK)5-8桁生産牧場のID。社台ファーム、ノーザンファームなどの大手から中小牧場までを識別。生産者名String20-40bytes生産牧場名。産地名String10-20bytes北海道浦河、新ひだか、あるいは米国、愛国などの生産地。外国産馬（マル外）の判定に使用される。父馬名String18-30bytes血統分析の主要ファクター。母馬名String18-30bytes牝系分析のキー。母父馬名String18-30bytesブルードメアサイアー（BMS）。配合理論において重要視される。インサイトと詳細分析:UmaConnの競走馬マスタには、これら基本情報に加え、複雑な「抹消フラグ」や「転入出区分」が含まれている可能性が高い。地方競馬では、能力検定（能検）の受検履歴や、JRAからの転入時の格付け（クラス編成）に必要な「収得賞金」「番組賞金」という2つの異なる賞金概念が存在する。収得賞金はJRAと同様の基準だが、番組賞金は各競馬組合独自の計算式（過去の着順やレース格に基づくポイント制）で算出されるため、UmaConnから提供される「賞金データ」は単一のフィールドではなく、複数の賞金カテゴリ（総賞金、収得賞金、番組賞金、付加賞金）に分化されている点に注意が必要である。また、血統データに関しては、単に親の名前だけでなく、Target Frontier JVの機能に見られるように「5代血統表」を構築可能な深度を持っている。これは、内部的に数万頭規模の繁殖馬マスタ（Ancestry Master）へのポインタを保持していることを意味する。3.2 騎手・調教師マスタ (Personality Master Entities)人間系のデータもまた、オッズ形成や競走結果に多大な影響を与えるファクターである。フィールド論理名詳細定義と分析的視点騎手/調教師コードシステム内で一意のID。所属（本所属）地方競馬の騎手は原則として特定の競馬場（主催者）に所属する。例：大井、園田、高知など。現在所属「期間限定騎乗」制度により、高知の騎手が南関東で騎乗する場合などがある。この動的な所属変更を管理するフィールド。免許区分平地、障害（地方では極めて稀）、ばんえい等の免許種類。減量区分見習騎手の減量特典（☆1kg減、▲3kg減など）の適用状況。通算勝利数によって変動するため、自動更新される動的属性である。初免許年/キャリアベテランか新人かの指標。通算成績1着、2着、3着、着外の回数。勝率、連対率の計算ソース。インサイト:地方競馬独特の要素として「勝負服」の扱いがある。JRAでは馬主ごとの勝負服が基本だが、地方競馬では「騎手服（騎手ごとの固有デザイン）」が基本となる（ホッカイドウ競馬や交流重賞など一部例外あり）。したがって、騎手マスタには「勝負服の柄定義データ（色、模様コード）」が含まれているか、あるいは別テーブルとしてリンクされている。これはビジュアライゼーションにおいて重要なファクターである。3.3 コース・競馬場マスタ (Track Master)全国の地方競馬場それぞれの物理的特性を定義する。競馬場コード: NAR体系に基づくコード（例：30=大井, 42=浦和など）。コースID: 同一競馬場内でのコース使い分け（内回り、外回り、フルゲート頭数の違い）。距離: メートル単位。トラック区分: ダート（主流）、芝（盛岡）、ばんえい（帯広）。左右: 右回り、左回り。直線長: 第4コーナーからゴール板までの距離。高低差: コース全体の最大高低差。4. 競走番組・出馬表データ（Program & Entry Data）レース当日の状況を記述する動的データ群であり、予測モデルの入力変数（Feature Vectors）の大部分を構成する。4.1 レース詳細ヘッダ (Race Header)1つのレースを定義する環境変数群。項目名概要・仕様レースID (PK)YYYYMMDD + 場所コード + レース番号で構成される複合キー。開催回次「第X回 〇〇競馬 Y日目」という開催サイクル情報。馬場状態の経時変化（使い込みによる荒れ）を分析する上で「何日目か」は極めて重要。レース名特別競走や重賞の名称。副題（スポンサー名）が含まれる場合もある。競走条件（クラス）「C1」「B2三組」「3歳オープン」など。ここには厳格なヒエラルキーが存在し、クラスが上がれば走破タイムの基準も厳しくなる。競走種別一般、特別、準重賞、重賞(Jpn1-3, G1-3)。条件詳細「牝馬限定」「JRA交流」「新人騎手招待」などの特記事項。距離・コース前述のマスタコードへの参照。天候晴、曇、雨、小雨、雪。レース発走時点の天候が記録される。馬場状態良（Dry）、稍重（Yielding）、重（Soft）、不良（Heavy）。含水率によって判定され、走破時計に劇的な影響を与えるファクター。発走時刻予定発走時刻。ナイター開催（トゥインクルレース等）の識別にもなる。4.2 出馬表レコード (Entry Records)各レースにおける出走馬ごとの詳細データ。1レースあたり最大16レコード（フルゲート）が存在する。項目名詳細仕様ファクターとしての重要性枠番1〜8。地方競馬の小回りコースでは、内枠・外枠の有利不利が顕著に出るため、重要なバイアス要因となる。馬番1〜16。オッズや投票における識別番号。血統登録番号FK。馬マスタへのリンク。馬名表示用。負担重量（斤量）54.0kgなど。ハンデ戦や別定戦での斤量差は、スピード指数補正の核心となる数値。騎手コードFK。予定騎手。乗り替わりが発生した場合は更新される。調教師コードFK。馬体重kg単位。レース当日に計測・発表される。前走比（+10kgなど）も同時に提供される。急激な増減は状態変化を示唆する。ブリンカー有無Boolean。メンコやブリンカーなどの馬具着用情報。集中力に影響。脚質予想コード/記号。専門紙データに基づく「逃げ」「先行」「差し」「追込」の区分。展開シミュレーションに使用。予想印コード。◎、〇、▲、△などの予想記号（提供元データが含まれる場合）。詳細分析：地方競馬特有のファクター所属地区: 地方競馬では「他地区からの遠征」が頻繁にある。例えば、園田のレースに高知の馬が出走する場合などである。UmaConnのデータには「自場/他場」を識別するフラグ、あるいは所属厩舎のエリアコードが含まれており、これによって「遠征による輸送疲れ」や「地元の利」をモデル化することが可能となる。番組ポイント: 南関東などのクラス分けで使用される保有ポイント数。昇級・降級の判定に使われる数値データ。5. 競走成績・結果データ詳解（Result Data）レース終了後に確定する「結果」データは、過去データ分析（Backtesting）の中核をなす。UmaConnの強みは、この結果データに含まれる「経過情報」の豊かさにある。5.1 確定順位とタイム情報項目名詳細仕様データ型着順確定した順位。降着や失格の場合はその旨のコードが付与される。Integer / Code入線順位審議前の到達順位。Integer走破タイム分・秒・1/10秒単位。指数計算の基礎となる絶対値。Time / Numeric着差1着馬（または前着馬）とのタイム差、もしくは身体差（ハナ、クビ、1/2馬身、大差など）。String / Codeタイム指数各社独自のスピード指数が含まれる場合がある（UmaConn拡張仕様）。Numeric5.2 通過順と展開データ（Passing Order & Pace）レースの展開（どのようなペースで進んだか）を復元するためのデータ群。コーナー通過順: 「3-3-2-1」のように、各コーナー（1角、2角、3角、4角）での位置取りを示す文字列データ。これが解析できることで、「逃げて潰れた」「後方から追い込んだ」といったレース内容の質的評価が可能になる。ラップタイム: 先頭馬が200m（1ハロン）ごとに通過したタイムの配列。S1 (Start-200m)S2 (200m-400m)...L3 (Last 3F: ゴール前600m)L2L1テン3F / 上がり3F: スタート後600mのタイム（ダッシュ力）と、ゴール前600mのタイム（末脚）。ペース配分（ハイペース、スローペース）を判断する決定的指標。インサイト：PCI（Pace Change Index）への応用Target Frontier JV等の仕様1に見られるように、UmaConnのラップタイムデータを利用して「PCI（ペースチェンジ指数）」や「RPCI（レースペースチェンジ指数）」を算出することが推奨される。これは、前半と後半のペース比率を数値化したものであり、その馬が「消耗戦に強い」のか「瞬発力勝負に強い」のかを分類するために不可欠な二次加工データである。5.3 配当・払戻金データ単勝・複勝払戻金: 的中馬番と金額。枠連、馬連、馬単、ワイド、3連複、3連単: 全的中組み合わせと払戻金。特払い: 全員的中なしの場合の70円返還などの特殊コード。6. オッズ・票数データの詳細構造（Investment Metrics）UmaConnの最大の特徴の一つは、高度な「時系列オッズ分析」を可能にするデータ粒度である。現代の競馬において、オッズは単なる配当予測ではなく、市場心理とインサイダー情報の集合体として扱われる。6.1 オッズデータの多層構造オッズデータは、単一の値ではなく、以下のマトリクスとして提供される。券種別レイヤー:単勝 (Win)複勝 (Place) - 複勝は「範囲オッズ（下限〜上限）」として提供されることが多い。枠連 (Bracket Quinella)馬連 (Quinella)馬単 (Exacta)ワイド (Quinella Place)3連複 (Trio)3連単 (Tierce)組み合わせ数（データボリューム）:16頭立ての場合、3連単の組み合わせは $16 \times 15 \times 14 = 3,360$ 通りとなる。全場の全レースについてこれだけのデータポイントが生成されるため、UmaConnは圧縮バイナリ形式または効率的なCSV構造でこれらを配信する。6.2 時系列（Tick）データと票数UmaConn対応ソフト「時系列オッズViewer2」2の存在が示す通り、オッズデータには時間軸の概念がある。取得時刻: データがスナップショットされたタイムスタンプ（例：10:05:00, 10:10:00... 締め切り直前）。票数（Votes）: 各買い目に対する純粋な投票数。オッズは (総票数 × 控除率) / 当該票数 で計算される結果に過ぎないため、プロフェッショナルな分析ではオッズ値よりも「票数」そのものの変動（大口投票の流入）を追跡する。得票率（Support Rate）: 全投票数に対するシェア。分析的インサイト：異常オッズの検知「朝一オッズ」と「直前オッズ」の乖離、あるいは「特定の馬単だけ異常に売れている」といった現象（インサイダー投票の疑い）を検知するためには、この時系列票数データが必須となる。UmaConnの仕様では、これらを「時系列オッズファイル」として蓄積・出力する機能がサポートされており、機械学習モデルにおける「市場心理特徴量」として利用可能である。7. 拡張データおよび外部連携仕様UmaConnは、ユーザーが生成したデータやサードパーティ製の指数を取り込むためのオープンな仕様を持っている。7.1 外部指数インターフェース (External Index Interface)スニペット1により、CSV形式での外部指数インポートがサポートされていることが確認できる。フォーマット: レースIDまたは馬番に紐づく形で、数値データ（指数）をインポート可能。利用用途: ユーザー独自のAIモデルが出力した「勝率予測」や、専門紙が販売する「スピード指数」をUmaConn内のデータと結合し、Target Frontier JVなどの画面上で一元管理・フィルタリングするために使用される。機能: 外部指数によるソート、指数順位によるオッズ断層の分析、指数上位馬の回収率シミュレーション。7.2 テキスト・コメント情報結果コメント: 「出遅れたが直線よく伸びた」等の短評。チェック馬コメント: ユーザーが次回出走時のために残すメモ。同厩舎情報: 3にある通り、「本日同厩馬」の検索機能に関連するデータ。これは調教師の「勝負気配（多頭出しなど）」を読むための重要なメタデータである。8. 推奨データエンジニアリング戦略ここでは、UmaConnから抽出可能な全ファクターを統合し、独自の分析システムを構築する場合のデータベース設計指針と、具体的なファクターリストを提示する。8.1 網羅的ファクターリスト（詳細カテゴリ別）以下は、システム設計書における「カラム定義書」として利用可能なレベルのリストである。カテゴリA：レース環境・条件 (Race Context)ymd (開催年月日: Date)basho_code (競馬場コード: Char(2))kai (開催回: Int)nichi (開催日次: Int)race_no (レース番号: Int)race_name (レース名: Varchar)race_name_sub (レース名副題: Varchar)class_code (クラスコード: Char)distance (距離: Int)track_type (トラック区分: Char)weather (天候コード: Char)track_cond (馬場状態コード: Char)start_time (発走時刻: Time)head_count (出走頭数: Int)course_feature (コース特性フラグ: Bitmask - 内枠有利、外差し傾向など)カテゴリB：競走馬・出走属性 (Horse & Entry Profile)uma_ban (馬番: Int)waku_ban (枠番: Int)blood_no (血統登録番号: Char(10) - Unique Key)horse_name (馬名: Varchar)sex (性別: Char)age (馬齢: Int)coat_color (毛色: Char)weight_carry (負担重量: Decimal(3,1))jockey_code (騎手コード: Char(5))jockey_name (騎手名: Varchar)trainer_code (調教師コード: Char(5))trainer_name (調教師名: Varchar)owner_code (馬主コード: Char)breeder_code (生産者コード: Char)f_blood_no (父ID)m_blood_no (母ID)ff_blood_no (父父ID)fm_blood_no (父母ID)mf_blood_no (母父ID - BMS)mm_blood_no (母母ID)belong_area (所属地区コード: Char)previous_class (前走クラス: Char)running_style_pred (脚質予想: Char)カテゴリC：レース結果・パフォーマンス (Performance Metrics)finish_order (確定着順: Int)arrival_order (入線順位: Int)finish_time (走破タイム: Time/Ms)time_diff (着差: Decimal/Varchar)margin_code (着差コード: Char)corner_1 (1角通過順: Int)corner_2 (2角通過順: Int)corner_3 (3角通過順: Int)corner_4 (4角通過順: Int)lap_times (ラップタイム配列: JSON/Array)last_3f (上がり3Fタイム: Decimal(3,1))horse_weight (馬体重: Int)weight_change (体重増減: Int)prize_money (獲得賞金: Int)penalty_code (制裁コード: Char - 出遅れ、斜行など)カテゴリD：オッズ・人気指標 (Market Data)win_odds (単勝オッズ: Decimal)pop_order (人気順: Int)place_odds_min (複勝オッズ下限: Decimal)place_odds_max (複勝オッズ上限: Decimal)vote_count_win (単勝票数: Int)total_pool_win (単勝総票数: Int)以下、全券種×全組み合わせについて同様のフィールドが存在8.2 総ファクター数の推計上記リストに基づき、1レースあたりの有効データポイント（ファクター数）を推計する。静的属性: 約50項目 × 出走頭数（最大16） ≒ 800項目結果属性: 約40項目 × 16頭 ≒ 640項目血統属性（5代）: IDのみでも30項目 × 16頭 ≒ 480項目オッズ属性:基本オッズ（単複枠馬連ワイド）：約300項目3連系オッズ（3連単）：3360通り × 2（オッズ+票数） = 6,720項目合計: 1レースあたり 約8,000 〜 10,000 ファクターこの膨大なデータ量は、UmaConnが単なる情報閲覧ツールではなく、高度な数値解析のためのデータ供給パイプラインであることを示している。9. 結論および実装への提言本調査の結果、地方競馬DATA「UmaConn」は、中央競馬におけるJRA-VANに匹敵する、極めて詳細かつ構造化されたデータを提供していることが確認された。特に以下の点が、開発者およびアナリストにとっての重要なテイクアウェイとなる。データ構造の互換性: 多くのフィールド定義やコード体系がJRA標準（JV-Link）と親和性が高く設計されているため、既存の中央競馬分析ロジックやソフトウェア資産（Target Frontier JV等）を地方競馬へ容易に移植・適用可能である。時系列解析の潜在能力: オッズや馬体重の時系列変化データが含まれている点は、静的なデータ分析を超えた「マーケットマイクロストラクチャー」の研究や、AIを用いた異常検知モデルの構築において決定的なアドバンテージとなる。拡張性と統合: 外部指数インポート機能やCSV出力の柔軟性は、UmaConnを単体で使用するだけでなく、PythonやRを用いた独自の機械学習パイプラインの一部として組み込む運用（ETLプロセス）に最適である。実装への推奨アクション:開発者は、まず「Target Frontier JV（地方競馬版）」のCSV出力定義ファイルを詳細に設定し、これをマスタースキーマとして利用することを推奨する。これにより、公式ドキュメントの不足を補い、実データに基づいた堅牢なデータベースを構築することが可能となる。また、時系列オッズデータの取得にはディスク容量と処理速度が要求されるため、十分なリソース設計が必要である。以上の仕様に基づき、UmaConnは地方競馬データの「未開拓地」を掘り起こすための強力なプラットフォームであると結論付けられる。