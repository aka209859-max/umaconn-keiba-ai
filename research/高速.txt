E:\UmaData\nar-analytics-python-v2>cd /d E:\UmaData\nar-analytics-python-v2

E:\UmaData\nar-analytics-python-v2>C:\Users\ihaji\AppData\Local\Programs\Python\Python314\python.exe create_ml_dataset_fast.py

================================================================================
🏇 NAR-SI Ver.3.0 機械学習データセット作成
================================================================================

📡 データベース接続中...
✅ データベース接続成功


================================================================================
📊 2023年訓練データセット作成
================================================================================

================================================================================
📊 2023年のデータセット作成開始
================================================================================

✅ 対象レース数: 13676件
   - 除外: KB83（帯広ばんえい）
   - 除外: KB54 race_bango='12'（高知最終レース）

   処理済み: 100/13676レース
   処理済み: 200/13676レース
   処理済み: 300/13676レース
   処理済み: 400/13676レース
   処理済み: 500/13676レース
   処理済み: 600/13676レース
   処理済み: 700/13676レース
   処理済み: 800/13676レース
   処理済み: 900/13676レース
   処理済み: 1000/13676レース
   処理済み: 1100/13676レース
   処理済み: 1200/13676レース
   処理済み: 1300/13676レース
   処理済み: 1400/13676レース
   処理済み: 1500/13676レース
   処理済み: 1600/13676レース
   処理済み: 1700/13676レース
   処理済み: 1800/13676レース
   処理済み: 1900/13676レース
   処理済み: 2000/13676レース
   処理済み: 2100/13676レース
   処理済み: 2200/13676レース
   処理済み: 2300/13676レース
   処理済み: 2400/13676レース
   処理済み: 2500/13676レース
   処理済み: 2600/13676レース
   処理済み: 2700/13676レース
   処理済み: 2800/13676レース
   処理済み: 2900/13676レース
   処理済み: 3000/13676レース
   処理済み: 3100/13676レース
   処理済み: 3200/13676レース
   処理済み: 3300/13676レース
   処理済み: 3400/13676レース
   処理済み: 3500/13676レース
   処理済み: 3600/13676レース
   処理済み: 3700/13676レース
   処理済み: 3800/13676レース
   処理済み: 3900/13676レース
   処理済み: 4000/13676レース
   処理済み: 4100/13676レース
   処理済み: 4200/13676レース
   処理済み: 4300/13676レース
   処理済み: 4400/13676レース
   処理済み: 4500/13676レース
   処理済み: 4600/13676レース
   処理済み: 4700/13676レース
   処理済み: 4800/13676レース
   処理済み: 4900/13676レース
   処理済み: 5000/13676レース
   処理済み: 5100/13676レース
   処理済み: 5200/13676レース
   処理済み: 5300/13676レース
   処理済み: 5400/13676レース
   処理済み: 5500/13676レース
   処理済み: 5600/13676レース
   処理済み: 5700/13676レース
   処理済み: 5800/13676レース
   処理済み: 5900/13676レース
   処理済み: 6000/13676レース
   処理済み: 6100/13676レース
   処理済み: 6200/13676レース
   処理済み: 6300/13676レース
   処理済み: 6400/13676レース
   処理済み: 6500/13676レース
   処理済み: 6600/13676レース
   処理済み: 6700/13676レース
   処理済み: 6800/13676レース
   処理済み: 6900/13676レース
   処理済み: 7000/13676レース
   処理済み: 7100/13676レース
   処理済み: 7200/13676レース
   処理済み: 7300/13676レース
   処理済み: 7400/13676レース
   処理済み: 7500/13676レース
   処理済み: 7600/13676レース
   処理済み: 7700/13676レース
   処理済み: 7800/13676レース
   処理済み: 7900/13676レース
   処理済み: 8000/13676レース
   処理済み: 8100/13676レース
   処理済み: 8200/13676レース
   処理済み: 8300/13676レース
   処理済み: 8400/13676レース
   処理済み: 8500/13676レース
   処理済み: 8600/13676レース
   処理済み: 8700/13676レース
   処理済み: 8800/13676レース
   処理済み: 8900/13676レース
   処理済み: 9000/13676レース
   処理済み: 9100/13676レース
   処理済み: 9200/13676レース
   処理済み: 9300/13676レース
   処理済み: 9400/13676レース
   処理済み: 9500/13676レース
   処理済み: 9600/13676レース
   処理済み: 9700/13676レース
   処理済み: 9800/13676レース
   処理済み: 9900/13676レース
   処理済み: 10000/13676レース
   処理済み: 10100/13676レース
   処理済み: 10200/13676レース
   処理済み: 10300/13676レース
   処理済み: 10400/13676レース
   処理済み: 10500/13676レース
   処理済み: 10600/13676レース
   処理済み: 10700/13676レース
   処理済み: 10800/13676レース
   処理済み: 10900/13676レース
   処理済み: 11000/13676レース
   処理済み: 11100/13676レース
   処理済み: 11200/13676レース
   処理済み: 11300/13676レース
   処理済み: 11400/13676レース
   処理済み: 11500/13676レース
   処理済み: 11600/13676レース
   処理済み: 11700/13676レース
   処理済み: 11800/13676レース
   処理済み: 11900/13676レース
   処理済み: 12000/13676レース
   処理済み: 12100/13676レース
   処理済み: 12200/13676レース
   処理済み: 12300/13676レース
   処理済み: 12400/13676レース
   処理済み: 12500/13676レース
   処理済み: 12600/13676レース
   処理済み: 12700/13676レース
   処理済み: 12800/13676レース
   処理済み: 12900/13676レース
   処理済み: 13000/13676レース
   処理済み: 13100/13676レース
   処理済み: 13200/13676レース
   処理済み: 13300/13676レース
   処理済み: 13400/13676レース
   処理済み: 13500/13676レース
   処理済み: 13600/13676レース

✅ データセット作成完了
   - 処理済みレース: 13676件
   - スキップ（出走馬なし）: 0件
   - スキップ（過去走なし）: 5405件
   - Model A（南関東4場）: 35995頭
   - Model B（その他競馬場）: 97474頭

✅ 訓練データセット保存完了
   - Model A: data/train_dataset_model_a_2023.csv (35995行)
   - Model B: data/train_dataset_model_b_2023.csv (97474行)


================================================================================
📊 2024年テストデータセット作成
================================================================================

================================================================================
📊 2024年のデータセット作成開始
================================================================================

✅ 対象レース数: 13731件
   - 除外: KB83（帯広ばんえい）
   - 除外: KB54 race_bango='12'（高知最終レース）

   処理済み: 100/13731レース
   処理済み: 200/13731レース
   処理済み: 300/13731レース
   処理済み: 400/13731レース
   処理済み: 500/13731レース
   処理済み: 600/13731レース
   処理済み: 700/13731レース
   処理済み: 800/13731レース
   処理済み: 900/13731レース
   処理済み: 1000/13731レース
   処理済み: 1100/13731レース
   処理済み: 1200/13731レース
   処理済み: 1300/13731レース
   処理済み: 1400/13731レース
   処理済み: 1500/13731レース
   処理済み: 1600/13731レース
   処理済み: 1700/13731レース
   処理済み: 1800/13731レース
   処理済み: 1900/13731レース
   処理済み: 2000/13731レース
   処理済み: 2100/13731レース
   処理済み: 2200/13731レース
   処理済み: 2300/13731レース
   処理済み: 2400/13731レース
   処理済み: 2500/13731レース
   処理済み: 2600/13731レース
   処理済み: 2700/13731レース
   処理済み: 2800/13731レース
   処理済み: 2900/13731レース
   処理済み: 3000/13731レース
   処理済み: 3100/13731レース
   処理済み: 3200/13731レース
   処理済み: 3300/13731レース
   処理済み: 3400/13731レース
   処理済み: 3500/13731レース
   処理済み: 3600/13731レース
   処理済み: 3700/13731レース
   処理済み: 3800/13731レース
   処理済み: 3900/13731レース
   処理済み: 4000/13731レース
   処理済み: 4100/13731レース
   処理済み: 4200/13731レース
   処理済み: 4300/13731レース
   処理済み: 4400/13731レース
   処理済み: 4500/13731レース
   処理済み: 4600/13731レース
   処理済み: 4700/13731レース
   処理済み: 4800/13731レース
   処理済み: 4900/13731レース
   処理済み: 5000/13731レース
   処理済み: 5100/13731レース
   処理済み: 5200/13731レース
   処理済み: 5300/13731レース
   処理済み: 5400/13731レース
   処理済み: 5500/13731レース
   処理済み: 5600/13731レース
   処理済み: 5700/13731レース
   処理済み: 5800/13731レース
   処理済み: 5900/13731レース
   処理済み: 6000/13731レース
   処理済み: 6100/13731レース
   処理済み: 6200/13731レース
   処理済み: 6300/13731レース
   処理済み: 6400/13731レース
   処理済み: 6500/13731レース
   処理済み: 6600/13731レース
   処理済み: 6700/13731レース
   処理済み: 6800/13731レース
   処理済み: 6900/13731レース
   処理済み: 7000/13731レース
   処理済み: 7100/13731レース
   処理済み: 7200/13731レース
   処理済み: 7300/13731レース
   処理済み: 7400/13731レース
   処理済み: 7500/13731レース
   処理済み: 7600/13731レース
   処理済み: 7700/13731レース
   処理済み: 7800/13731レース
   処理済み: 7900/13731レース
   処理済み: 8000/13731レース
   処理済み: 8100/13731レース
   処理済み: 8200/13731レース
   処理済み: 8300/13731レース
   処理済み: 8400/13731レース
   処理済み: 8500/13731レース
   処理済み: 8600/13731レース
   処理済み: 8700/13731レース
   処理済み: 8800/13731レース
   処理済み: 8900/13731レース
   処理済み: 9000/13731レース
   処理済み: 9100/13731レース
   処理済み: 9200/13731レース
   処理済み: 9300/13731レース
   処理済み: 9400/13731レース
   処理済み: 9500/13731レース
   処理済み: 9600/13731レース
   処理済み: 9700/13731レース
   処理済み: 9800/13731レース
   処理済み: 9900/13731レース
   処理済み: 10000/13731レース
   処理済み: 10100/13731レース
   処理済み: 10200/13731レース
   処理済み: 10300/13731レース
   処理済み: 10400/13731レース
   処理済み: 10500/13731レース
   処理済み: 10600/13731レース
   処理済み: 10700/13731レース
   処理済み: 10800/13731レース
   処理済み: 10900/13731レース
   処理済み: 11000/13731レース
   処理済み: 11100/13731レース
   処理済み: 11200/13731レース
   処理済み: 11300/13731レース
   処理済み: 11400/13731レース
   処理済み: 11500/13731レース
   処理済み: 11600/13731レース
   処理済み: 11700/13731レース
   処理済み: 11800/13731レース
   処理済み: 11900/13731レース
   処理済み: 12000/13731レース
   処理済み: 12100/13731レース
   処理済み: 12200/13731レース
   処理済み: 12300/13731レース
   処理済み: 12400/13731レース
   処理済み: 12500/13731レース
   処理済み: 12600/13731レース
   処理済み: 12700/13731レース
   処理済み: 12800/13731レース
   処理済み: 12900/13731レース
   処理済み: 13000/13731レース
   処理済み: 13100/13731レース
   処理済み: 13200/13731レース
   処理済み: 13300/13731レース
   処理済み: 13400/13731レース
   処理済み: 13500/13731レース
   処理済み: 13600/13731レース
   処理済み: 13700/13731レース

✅ データセット作成完了
   - 処理済みレース: 13731件
   - スキップ（出走馬なし）: 0件
   - スキップ（過去走なし）: 5358件
   - Model A（南関東4場）: 35750頭
   - Model B（その他競馬場）: 99645頭

✅ テストデータセット保存完了
   - Model A: data/test_dataset_model_a_2024.csv (35750行)
   - Model B: data/test_dataset_model_b_2024.csv (99645行)


================================================================================
📊 データセット作成サマリー
================================================================================

【訓練データ（2023年）】
  Model A（南関東4場）: 35,995行
  Model B（その他競馬場）: 97,474行
  合計: 133,469行

【テストデータ（2024年）】
  Model A（南関東4場）: 35,750行
  Model B（その他競馬場）: 99,645行
  合計: 135,395行

【特徴量数】
  Model A: 31個（共通18個 + 後半3F関連7個）
  Model B: 23個（共通18個のみ）

【除外ルール】
  - KB83（帯広ばんえい）: 全除外
  - KB54 race_bango='12'（高知最終レース）: 除外

================================================================================
🎉 データセット作成完了！
================================================================================

次のステップ: Phase 3-2（モデル訓練）
  → python train_lightgbm_ranker.py

📡 データベース接続を切断しました


E:\UmaData\nar-analytics-python-v2>